var Web3 = require('web3');
var web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
web3.eth.defaultAccount = web3.eth.accounts[0];

var contractAdd = "0x4927fb5da1cc6dad8e0a7e7a29d13181c99152e2";
var contractABI = [
    {
        "constant": true,
        "inputs": [],
        "name": "why",
        "outputs": [
            {
                "name": "",
                "type": "bytes"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "who",
        "outputs": [
            {
                "name": "",
                "type": "string"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "name": "they",
        "outputs": [
            {
                "name": "",
                "type": "address"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "stringLength",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "bytesLength",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "arrayLength",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": false,
        "inputs": [
            {
                "name": "_who",
                "type": "string"
            },
            {
                "name": "_why",
                "type": "bytes"
            },
            {
                "name": "_they",
                "type": "address[]"
            }
        ],
        "name": "foo",
        "outputs": [],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    }
];

var contract = web3.eth.contract(contractABI).at(contractAdd);

// "AAAA", ["0x42", "0x43", "0x44"], ["0x01", "0x02"]
var defaultArgs = [
    '0x5fc059fd',
    '0000000000000000000000000000000000000000000000000000000000000060',
    '00000000000000000000000000000000000000000000000000000000000000a0',
    '00000000000000000000000000000000000000000000000000000000000000e0',
    '0000000000000000000000000000000000000000000000000000000000000004',
    '4141414100000000000000000000000000000000000000000000000000000000',
    '0000000000000000000000000000000000000000000000000000000000000003',
    '4243440000000000000000000000000000000000000000000000000000000000',
    '0000000000000000000000000000000000000000000000000000000000000002',
    '0000000000000000000000000000000000000000000000000000000000000001',
    '0000000000000000000000000000000000000000000000000000000000000002'
];

var modifiedArgs = [
    '0x5fc059fd',
    '0000000000000000000000000000000000000000000000000000000000000060',
    '00000000000000000000000000000000000000000000000000000000000000a0',
    '00000000000000000000000000000000000000000000000000000000000000e0',
    '0000000000000000000000000000000000000000000000000000000000000040',
    '4141414100000000000000000000000000000000000000000000000000000000',
    '0000000000000000000000000000000000000000000000000000000000000040',
    '4243440000000000000000000000000000000000000000000000000000000000',
    '0000000000000000000000000000000000000000000000000000000000000040',
    '0000000000000000000000000000000000000000000000000000000000000001',
    '0000000000000000000000000000000000000000000000000000000000000002'
];

defaultData = defaultArgs.join("");
modifiedData = modifiedArgs.join("");

var tx = web3.eth.sendTransaction({
    "to" : contractAdd,
    "data" : modifiedData,
    "gas" : 1185919
});

console.log("Transaction sent.", tx);

var filter = web3.eth.filter("latest");
filter.watch(function (lastBlock) {
    console.log("Transaction mined with status:", web3.eth.getTransactionReceipt(tx).status);
    filter.stopWatching();
});






